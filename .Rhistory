points(c(0:2), table(pmirep$num_reprod)/sum(table(pmirep$num_reprod)), type = "b", pch = 18, col = "darkgreen")
points(c(0:1), table(rmirep$num_reprod)/sum(table(rmirep$num_reprod)), type = "b", pch = 18, col = "yellowgreen")
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events",
ylab = "number individuals", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), bty = "n", main = "folivores")
points(c(0:1), table(shirep$num_reprod)/sum(table(shirep$num_reprod)), type = "b", pch = 17, col = "brown")
points(c(0:1), table(sfirep$num_reprod)/sum(table(sfirep$num_reprod)), type = "b", pch = 17, col = "brown4")
points(c(0:3), table(naoirep$num_reprod)/sum(table(naoirep$num_reprod)), type = "b", pch = 17, col = "goldenrod4")
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events",
ylab = "number individuals", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), main = "carnivores")
points(c(0:3), table(otirep$num_reprod)/sum(table(otirep$num_reprod)), type = "b", pch = 15, col = "orange3")
points(c(0:1), table(olirep$num_reprod)/sum(table(olirep$num_reprod)), type = "b", pch = 15, col = "orange4")
dev.off()
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
mos
yeras
years
y = 7
m = 5
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
tmp
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1)
for (m in 1:length(mos)){
for (y in 1:length(years)){
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
if (nrow(tmp) > 0){
num_females = nrow(tmp)
repro = subset(tmp, nipples == "E" | nipples == "B" | nipples == "R" | pregnant == "P")
prop_repro = nrow(repro)/num_females
mo_repros = c(years[y], mos[m], prop_repro, num_females)
}
else {
num_females = 0
mo_repros = c(years[y], mos[m], NA, num_females)
}
r_mo_df = rbind(r_mo_df, mo_repros)
}
}
ro_mo_df
mo_repros
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1)
for (m in 1:length(mos)){
for (y in 1:length(years)){
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
if (nrow(tmp) > 0){
num_females = nrow(tmp)
repro = subset(tmp, nipples == "E" | nipples == "B" | nipples == "R" | pregnant == "P")
prop_repro = nrow(repro)/num_females
mo_repros = c(years[y], mos[m], prop_repro, num_females)
}
else {
num_females = 0
mo_repros = c(years[y], mos[m], NA, num_females)
}
r_mo_df = rbind(r_mo_df, mo_repros)
}
}
r_mo_df
mo_repro = function (femaledata){
#returns the proportion of females that are reproductive (nipples enlarged - E - red - R- or both - B - or pregnant - P-)
#in each year. Only looks at data during years and months in which the species is present.
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1)
for (m in 1:length(mos)){
for (y in 1:length(years)){
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
if (nrow(tmp) > 0){
num_females = nrow(tmp)
repro = subset(tmp, nipples == "E" | nipples == "B" | nipples == "R" | pregnant == "P")
prop_repro = nrow(repro)/num_females
mo_repros = c(years[y], mos[m], prop_repro, num_females)
}
else {
num_females = 0
mo_repros = c(years[y], mos[m], NA, num_females)
}
r_mo_df = rbind(r_mo_df, mo_repros)
}
}
return(r_mo_df[-1,])
}
# proportion of reproductive females by month and year
doreprdyr = mo_repro(subset(het, species = "DO" & sex == "F")); dmreprdyr = mo_repro(subset(het, species == "DM" & sex == "F")); pfreprdyr = mo_repro(subset(het, species == "PF" & sex == "F")); ppreprdyr = mo_repro(subset(het, species == "PP" & sex == "F")); pbreprdyr = mo_repro(subset(het, species == "PB" & sex == "F"));
pereprdyr = mo_repro(subset(cricet, species == "PE" & sex == "F")); pmreprdyr = mo_repro(subset(cricet, species == "PM" & sex == "F")); rmreprdyr = mo_repro(subset(cricet, species == "RM" & sex == "F"))
shreprdyr = mo_repro(subset(foliv, species == "SH" & sex == "F")); sfreprdyr = mo_repro(subset(foliv, species == "SF" & sex == "F")); naoreprdyr = mo_repro(subset(foliv, species == "NAO" & sex == "F"))
otreprdyr = mo_repro(subset(insec, species == "OT" & sex == "F")); olreprdyr = mo_repro(subset(insec, species == "OL" & sex == "F"))
head(doreprdyr)
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "DO - krat")
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(dmreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DM - krat", years[y], sep = " "))
}
dmreprdyr
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,11,)
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,11),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,5),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,6),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,4),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,3),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,5),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,7),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,6),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,11),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,4),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,3),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,3.5),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month", xaxp = c(1,12,2),
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
data = subset(doreprdyr, year == years[y])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main =  paste("DO - krat", years[y], sep = " "))
}
head(femaledata)
head(r_mo_df)
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1, "species" = "DO")
species = femaledata[1,9]
species
mo_repro = function (femaledata){
#returns the proportion of females that are reproductive (nipples enlarged - E - red - R- or both - B - or pregnant - P-)
#in each year. Only looks at data during years and months in which the species is present.
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
species = femaledata[1,9]
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1, "species" = "DO")
for (m in 1:length(mos)){
for (y in 1:length(years)){
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
if (nrow(tmp) > 0){
num_females = nrow(tmp)
repro = subset(tmp, nipples == "E" | nipples == "B" | nipples == "R" | pregnant == "P")
prop_repro = nrow(repro)/num_females
mo_repros = c(years[y], mos[m], prop_repro, num_females, species)
}
else {
num_females = 0
mo_repros = c(years[y], mos[m], NA, num_females, species)
}
r_mo_df = rbind(r_mo_df, mo_repros)
}
}
return(r_mo_df[-1,])
}
# proportion of reproductive females by month and year
doreprdyr = mo_repro(subset(het, species = "DO" & sex == "F")); dmreprdyr = mo_repro(subset(het, species == "DM" & sex == "F")); pfreprdyr = mo_repro(subset(het, species == "PF" & sex == "F")); ppreprdyr = mo_repro(subset(het, species == "PP" & sex == "F")); pbreprdyr = mo_repro(subset(het, species == "PB" & sex == "F"));
pereprdyr = mo_repro(subset(cricet, species == "PE" & sex == "F")); pmreprdyr = mo_repro(subset(cricet, species == "PM" & sex == "F")); rmreprdyr = mo_repro(subset(cricet, species == "RM" & sex == "F"))
shreprdyr = mo_repro(subset(foliv, species == "SH" & sex == "F")); sfreprdyr = mo_repro(subset(foliv, species == "SF" & sex == "F")); naoreprdyr = mo_repro(subset(foliv, species == "NAO" & sex == "F"))
otreprdyr = mo_repro(subset(insec, species == "OT" & sex == "F")); olreprdyr = mo_repro(subset(insec, species == "OL" & sex == "F"))
warnings()
head(otreprdyr)
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
species = femaledata[1,9]
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1, "species" = "DO")
for (m in 1:length(mos)){
for (y in 1:length(years)){
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
if (nrow(tmp) > 0){
num_females = nrow(tmp)
repro = subset(tmp, nipples == "E" | nipples == "B" | nipples == "R" | pregnant == "P")
prop_repro = nrow(repro)/num_females
mo_repros = c(years[y], mos[m], prop_repro, num_females, species)
}
else {
num_females = 0
mo_repros = c(years[y], mos[m], NA, num_females, species)
}
r_mo_df = rbind(r_mo_df, mo_repros)
}
}
return(r_mo_df[-1,])
}
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
species = femaledata[1,9]
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1, "species" = "DO")
for (m in 1:length(mos)){
for (y in 1:length(years)){
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
if (nrow(tmp) > 0){
num_females = nrow(tmp)
repro = subset(tmp, nipples == "E" | nipples == "B" | nipples == "R" | pregnant == "P")
prop_repro = nrow(repro)/num_females
mo_repros = c(years[y], mos[m], prop_repro, num_females, species)
}
else {
num_females = 0
mo_repros = c(years[y], mos[m], NA, num_females, species)
}
r_mo_df = rbind(r_mo_df, mo_repros)
}
}
r_mo_df
mo_repro = function (femaledata){
#returns the proportion of females that are reproductive (nipples enlarged - E - red - R- or both - B - or pregnant - P-)
#in each year. Only looks at data during years and months in which the species is present.
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
species = femaledata[1,9]
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1, "species" = "DO")
for (m in 1:length(mos)){
for (y in 1:length(years)){
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
if (nrow(tmp) > 0){
num_females = nrow(tmp)
repro = subset(tmp, nipples == "E" | nipples == "B" | nipples == "R" | pregnant == "P")
prop_repro = round(nrow(repro)/num_females,4)
mo_repros = c(years[y], mos[m], prop_repro, num_females, species)
}
else {
num_females = 0
mo_repros = c(years[y], mos[m], NA, num_females, species)
}
r_mo_df = rbind(r_mo_df, mo_repros)
}
}
return(r_mo_df[-1,])
}
pereprdyr = mo_repro(subset(cricet, species == "PE" & sex == "F"));
head(subset(cricet, species == "PE" & sex == "F"))
warnings
pereprdyr
mo_repro = function (femaledata){
#returns the proportion of females that are reproductive (nipples enlarged - E - red - R- or both - B - or pregnant - P-)
#in each year. Only looks at data during years and months in which the species is present.
mos = c(1:12)
years = sort(unique(femaledata$yr)) #only look at data during years in which the species is present
species = femaledata[1,9]
r_mo_df =data.frame("year" = 1, "month" = 1, "proprepro" = 1, "numfemales" = 1, "species" = 1)
for (m in 1:length(mos)){
for (y in 1:length(years)){
tmp = subset(femaledata, yr == years[y])
tmp = subset(tmp, mo == mos[m])
if (nrow(tmp) > 0){
num_females = nrow(tmp)
repro = subset(tmp, nipples == "E" | nipples == "B" | nipples == "R" | pregnant == "P")
prop_repro = round(nrow(repro)/num_females,4)
mo_repros = c(years[y], mos[m], prop_repro, num_females, species)
}
else {
num_females = 0
mo_repros = c(years[y], mos[m], NA, num_females, species)
}
r_mo_df = rbind(r_mo_df, mo_repros)
}
}
return(r_mo_df[-1,])
}
pereprdyr = mo_repro(subset(cricet, species == "PE" & sex == "F"))
pereprdyr
doreprdyr = mo_repro(subset(het, species = "DO" & sex == "F")); dmreprdyr = mo_repro(subset(het, species == "DM" & sex == "F")); pfreprdyr = mo_repro(subset(het, species == "PF" & sex == "F")); ppreprdyr = mo_repro(subset(het, species == "PP" & sex == "F")); pbreprdyr = mo_repro(subset(het, species == "PB" & sex == "F"));
pereprdyr = mo_repro(subset(cricet, species == "PE" & sex == "F")); pmreprdyr = mo_repro(subset(cricet, species == "PM" & sex == "F")); rmreprdyr = mo_repro(subset(cricet, species == "RM" & sex == "F"))
shreprdyr = mo_repro(subset(foliv, species == "SH" & sex == "F")); sfreprdyr = mo_repro(subset(foliv, species == "SF" & sex == "F")); naoreprdyr = mo_repro(subset(foliv, species == "NAO" & sex == "F"))
otreprdyr = mo_repro(subset(insec, species == "OT" & sex == "F")); olreprdyr = mo_repro(subset(insec, species == "OL" & sex == "F"))
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr)
alldat
doreprdyr
doreprdyr = mo_repro(subset(het, species = "DO" & sex == "F"));
doreprdyr
f=subset(het, species = "DO" & sex == "F")
f
head(f)
f = subset(het, species == "DO")
head(f)
tail(f)
dim(f)
f = subset(het, species == "DO" & sex == "F")
dim(f)
head(f)
tail(f)
f = subset(het, species = "DO" & sex == "F")
dim(f)
head(f)
doreprdyr = mo_repro(subset(het, species == "DO" & sex == "F"));
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
dim(alldat)
10*12*13
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'SF', 'NAO', 'OT', 'OL')
length(spp)
head(alldata)
head(alldat)
data = subset(doreprdyr, year == years[y] & species == spp[s])
s = 1
data = subset(doreprdyr, year == years[y] & species == spp[s])
data
y
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main =  paste(spp[s], years[y], sep = " "))
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'SF', 'NAO', 'OT', 'OL')
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(doreprdyr, year == years[y] & species == spp[s])
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main =  paste(spp[s], years[y], sep = " "))
}
}
y
s
data
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'SF', 'NAO', 'OT', 'OL')
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(doreprdyr, year == years[y] & species == spp[s])
if(nrow(data) > 0){
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main =  paste(spp[s], years[y], sep = " "))
}}}
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'SF', 'NAO', 'OT', 'OL')
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'SF', 'NAO', 'OT', 'OL')
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(alldat, year == years[y] & species == spp[s])
if(nrow(data) > 0){
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n", main =  paste(spp[s], years[y], sep = " "))
}}}
pdf("Fig7_mo-yr_repro_trends.pdf", 7, 10, paper = "letter" pointsize = 10)
par(mfrow=c(5,2))
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'SF', 'NAO', 'OT', 'OL')
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(alldat, year == years[y] & species == spp[s])
if(nrow(data) > 0){
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n", main =  paste(spp[s], years[y], sep = " "))
}}}
dev.off()
pdf("Fig7_mo-yr_repro_trends.pdf", 7, 10, paper = "letter", pointsize = 10)
par(mfrow=c(5,2))
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'SF', 'NAO', 'OT', 'OL')
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(alldat, year == years[y] & species == spp[s])
if(nrow(data) > 0){
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n", main =  paste(spp[s], years[y], sep = " "))
}}}
dev.off()
pdf("Fig7_mo-yr_repro_trends.pdf", 7, 10, paper = "letter", pointsize = 10)
par(mfrow=c(5,2))
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'SF', 'NAO', 'OT', 'OL')
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(alldat, year == years[y] & species == spp[s])
if(nrow(data) > 0){
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n", main =  paste(spp[s], years[y], sep = " "))
}
else {
plot(NA, NA, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n",  main = paste(spp[s], years[y], sep = " "))
}}}
dev.off()
pdf("Fig7_mo-yr_repro_trends.pdf", 7, 10, paper = "letter", pointsize = 10)
par(mfrow=c(4,3))
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'NAO', 'OT', 'OL') #SF (fit all on a page, hardly reproduce anyway)
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(alldat, year == years[y] & species == spp[s])
if(nrow(data) > 0){
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n", main =  paste(spp[s], years[y], sep = " "))
}
else {
plot(NA, NA, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n",  main = paste( "No", spp[s], years[y], sep = " "))
}}}
dev.off()
pdf("Fig7_mo-yr_repro_trends.pdf", 7, 10, paper = "letter", pointsize = 10)
par(mfrow=c(4,3))
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'NAO', 'OT', 'OL') #SF (fit all on a page, hardly reproduce anyway)
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(alldat, year == years[y] & species == spp[s])
if(nrow(data) > 0){
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n", main =  paste(spp[s], years[y], sep = " "))
}
else {
plot(NA, NA, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n",  main = paste( "No", spp[s], years[y], sep = " "))
}}}
dev.off()
