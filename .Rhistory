labels = strtrim(as.character(names(nonzero)),2)
labels
nonzero
row = 2
yrdat = abuns[row,]
reldat = sort(yrdat/sum(yrdat), decreasing = TRUE)
nonzero = reldat[reldat>0]
labels = strtrim(as.character(names(nonzero)),2)
nonzero
row = 3
yrdat = abuns[row,]
reldat = sort(yrdat/sum(yrdat), decreasing = TRUE)
nonzero = reldat[reldat>0]
labels = strtrim(as.character(names(nonzero)),2)
nonzero
labels
row = 4
yrdat = abuns[row,]
reldat = sort(yrdat/sum(yrdat), decreasing = TRUE)
nonzero = reldat[reldat>0]
labels = strtrim(as.character(names(nonzero)),2)
nonzero
labels
row = 5
years = c(2000:2009)
ranks = c(1:13)
for (row in 1:nrow(abuns)){
yrdat = abuns[row,]
reldat = sort(yrdat/sum(yrdat), decreasing = TRUE)
nonzero = reldat[reldat>0]
labels = strtrim(as.character(names(nonzero)),2)
print(labels)
plot(ranks, reldat, type = "b", pch = 19, ylim = c(0,0.6),
xlab = "Rank", ylab = "Relative Abundance", bty = "n", xaxp = c(1, 13, 12))
mtext(years[row], side = 3)
textxy(c(1:length(nonzero)), nonzero, labs = labels, cx = 0.75)
}
head(het)
doabun = allyrs_abun(subset(het, species == "DO" & plot %in% c(1,2,4,8,9,11,14,17,22))); dmabun = allyrs_abun(subset(het, species == "DM")); pfabun = allyrs_abun(subset(het, species == "PF")); ppabun = allyrs_abun(subset(het, species == "PP")); pbabun = allyrs_abun(subset(het, species == "PB"))
doabun
dmabun
b = subset(het, species == "DO" & plot %in% c(1,2,4,8,9,11,14,17,22))
unique(b$plot)
length(unique(b$plot))
#mean abundances within all years on control plots only
doabun = allyrs_abun(subset(het, species == "DO" & plot %in% c(1,2,4,8,9,11,12,14,17,22))); dmabun = allyrs_abun(subset(het, species == "DM"& plot %in% c(1,2,4,8,9,11,12,14,17,22))); pfabun = allyrs_abun(subset(het, species == "PF"& plot %in% c(1,2,4,8,9,11,12,14,17,22))); ppabun = allyrs_abun(subset(het, species == "PP"& plot %in% c(1,2,4,8,9,11,12,14,17,22))); pbabun = allyrs_abun(subset(het, species == "PB"& plot %in% c(1,2,4,8,9,11,12,14,17,22)))
peabun = allyrs_abun(subset(cricet, species == "PE"& plot %in% c(1,2,4,8,9,11,12,14,17,22))); pmabun = allyrs_abun(subset(cricet, species == "PM"& plot %in% c(1,2,4,8,9,11,12,14,17,22))); rmabun = allyrs_abun(subset(cricet, species == "RM"& plot %in% c(1,2,4,8,9,11,12,14,17,22)))
shabun = allyrs_abun(subset(foliv, species == "SH"& plot %in% c(1,2,4,8,9,11,12,14,17,22))); sfabun = allyrs_abun(subset(foliv, species == "SF"& plot %in% c(1,2,4,8,9,11,12,14,17,22))); naoabun = allyrs_abun(subset(foliv, species == "NAO"& plot %in% c(1,2,4,8,9,11,12,14,17,22)))
otabun = allyrs_abun(subset(insec, species == "OT"& plot %in% c(1,2,4,8,9,11,12,14,17,22))); olabun = allyrs_abun(subset(insec, species == "OL"& plot %in% c(1,2,4,8,9,11,12,14,17,22)))
conabuns = cbind(doabun, dmabun, pbabun, ppabun, pfabun, peabun, pmabun, rmabun, shabun, sfabun, naoabun, otabun, olabun)
years = c(2000:2009)
ranks = c(1:13)
abuns = conabuns
for (row in 1:nrow(abuns)){
yrdat = abuns[row,]
reldat = sort(yrdat/sum(yrdat), decreasing = TRUE)
nonzero = reldat[reldat>0]
labels = strtrim(as.character(names(nonzero)),2)
print(labels)
plot(ranks, reldat, type = "b", pch = 19, ylim = c(0,0.6),
xlab = "Rank", ylab = "Relative Abundance", bty = "n", xaxp = c(1, 13, 12))
mtext(years[row], side = 3)
textxy(c(1:length(nonzero)), nonzero, labs = labels, cx = 0.75)
}
avgconranks = c(2.9, 3.9, 2.6, 1, 7.87, 7.1, 9.8, 9.3, 9, 8.6, 8.5, 4.8, 10.5)
length(avgconranks)
conranks = c(2.9, 3.9, 2.6, 1, 7.87, 7.1, 9.8, 9.3, 9, 8.6, 8.5, 4.8, 10.5)
plot(conranks[5], pfyr, xlim = c(0,1), ylim = c(0,1), xlab = "species average rank 2000-09", ylab = "across-year occupancy", pch = 19, col = "hotpink")
textxy(conranks[5], pfyr, "PF")
points(conranks[4],ppyr, pch = 19, col = "hotpink")
textxy(conranks[4],ppyr, "PP")
plot(conranks[5], pfyr, xlim = c(1,13), ylim = c(0,1), xlab = "species average rank 2000-09", ylab = "across-year occupancy", pch = 19, col = "hotpink")
textxy(conranks[5], pfyr, "PF")
points(conranks[4],ppyr, pch = 19, col = "hotpink")
textxy(conranks[4],ppyr, "PP")
points(conranks[3], pbyr, pch = 19, col = "hotpink")
textxy(conranks[3], pbyr, "PB")
points(conranks[2], doyr, pch = 19, col = "hotpink")
textxy(conranks[2], doyr, "DO")
points(conranks[1], dmyr, pch = 19, col = "hotpink")
textxy(conranks[1], dmyr, "DM")
points(conranks[6], peyr, pch = 19, col = "indianred4")
textxy(conranks[6], peyr, "PE")
points(conranks[7], pmyr, pch = 19, col = "indianred4")
textxy(conranks[7], pmyr, "PM")
points(conranks[8], rmyr, pch = 19, col = "indianred4")
textxy(conranks[8], rmyr, "RM")
points(conranks[12], otyr, pch = 19, col = "cadetblue4")
textxy(conranks[12], otyr, "OT")
points(conranks[13], olyr, pch = 17, col = "cadetblue4")
textxy(conranks[13], olyr, "OT")
points(conranks[9], shyr, pch = 17, col = "chartreuse3")
textxy(conranks[9], shyr, "SH")
points(conranks[10], sfyr, pch = 17, col = "chartreuse3")
textxy(conranks[10], sfyr, "SH")
points(conranks[11], naoyr, pch = 17, col = "chartreuse3")
textxy(conranks[11], naoyr, "NA")
abline(v = 5, lty = 2, col = 'gray40', lwd = 1)
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
pdf("Fig10_temporal_occ_spp_rank.pdf", 5, 5, pointsize = 10)
par(mfrow=c(1,1))
#average rank of each species 2000-2009 on control plots
#ordered: DM, DO, PB, PP, PF, PE, PM, RM, SH, SF, NA, OT, OL
conranks = c(2.9, 3.9, 2.6, 1, 7.87, 7.1, 9.8, 9.3, 9, 8.6, 8.5, 4.8, 10.5)
plot(conranks[5], pfyr, xlim = c(1,13), ylim = c(0,1), xlab = "species average rank 2000-09", ylab = "across-year occupancy", pch = 19, col = "hotpink")
textxy(conranks[5], pfyr, "PF")
points(conranks[4],ppyr, pch = 19, col = "hotpink")
textxy(conranks[4],ppyr, "PP")
points(conranks[3], pbyr, pch = 19, col = "hotpink")
textxy(conranks[3], pbyr, "PB")
points(conranks[2], doyr, pch = 19, col = "hotpink")
textxy(conranks[2], doyr, "DO")
points(conranks[1], dmyr, pch = 19, col = "hotpink")
textxy(conranks[1], dmyr, "DM")
points(conranks[6], peyr, pch = 19, col = "indianred4")
textxy(conranks[6], peyr, "PE")
points(conranks[7], pmyr, pch = 19, col = "indianred4")
textxy(conranks[7], pmyr, "PM")
points(conranks[8], rmyr, pch = 19, col = "indianred4")
textxy(conranks[8], rmyr, "RM")
points(conranks[12], otyr, pch = 19, col = "cadetblue4")
textxy(conranks[12], otyr, "OT")
points(conranks[13], olyr, pch = 17, col = "cadetblue4")
textxy(conranks[13], olyr, "OT")
points(conranks[9], shyr, pch = 17, col = "chartreuse3")
textxy(conranks[9], shyr, "SH")
points(conranks[10], sfyr, pch = 17, col = "chartreuse3")
textxy(conranks[10], sfyr, "SH")
points(conranks[11], naoyr, pch = 17, col = "chartreuse3")
textxy(conranks[11], naoyr, "NA")
abline(v = 5, lty = 2, col = 'gray40', lwd = 1)
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
dev.off()
#average proportion of reproductive females by month across all years
doreprd = mean_mo_repro(subset(het, species == "DO" & sex == "F")); dmreprd = mean_mo_repro(subset(het, species == "DM" & sex == "F")); pfreprd = mean_mo_repro(subset(het, species == "PF" & sex == "F")); ppreprd = mean_mo_repro(subset(het, species == "PP" & sex == "F")); pbreprd = mean_mo_repro(subset(het, species == "PB" & sex == "F"));
pereprd = mean_mo_repro(subset(cricet, species == "PE" & sex == "F")); pmreprd = mean_mo_repro(subset(cricet, species == "PM" & sex == "F")); rmreprd = mean_mo_repro(subset(cricet, species == "RM" & sex == "F"))
shreprd = mean_mo_repro(subset(foliv, species == "SH" & sex == "F")); sfreprd = mean_mo_repro(subset(foliv, species == "SF" & sex == "F")); naoreprd = mean_mo_repro(subset(foliv, species == "NAO" & sex == "F"))
otreprd = mean_mo_repro(subset(insec, species == "OT" & sex == "F")); olreprd = mean_mo_repro(subset(insec, species == "OL" & sex == "F"))
# proportion of reproductive females by month and year
doreprdyr = mo_repro(subset(het, species == "DO" & sex == "F")); dmreprdyr = mo_repro(subset(het, species == "DM" & sex == "F")); pfreprdyr = mo_repro(subset(het, species == "PF" & sex == "F")); ppreprdyr = mo_repro(subset(het, species == "PP" & sex == "F")); pbreprdyr = mo_repro(subset(het, species == "PB" & sex == "F"));
pereprdyr = mo_repro(subset(cricet, species == "PE" & sex == "F")); pmreprdyr = mo_repro(subset(cricet, species == "PM" & sex == "F")); rmreprdyr = mo_repro(subset(cricet, species == "RM" & sex == "F"))
shreprdyr = mo_repro(subset(foliv, species == "SH" & sex == "F")); sfreprdyr = mo_repro(subset(foliv, species == "SF" & sex == "F")); naoreprdyr = mo_repro(subset(foliv, species == "NAO" & sex == "F"))
otreprdyr = mo_repro(subset(insec, species == "OT" & sex == "F")); olreprdyr = mo_repro(subset(insec, species == "OL" & sex == "F"))
#track the number of times females uniquely reproduce within years
doirep = indiv_repro(subset(het, species == "DO" & sex == "F")); dmirep = indiv_repro(subset(het, species == "DM" & sex == "F")); pfirep = indiv_repro(subset(het, species == "PF" & sex == "F")); ppirep = indiv_repro(subset(het, species == "PP" & sex == "F")); pbirep = indiv_repro(subset(het, species == "PB" & sex == "F"));
peirep = indiv_repro(subset(cricet, species == "PE" & sex == "F")); pmirep = indiv_repro(subset(cricet, species == "PM" & sex == "F")); rmirep = indiv_repro(subset(cricet, species == "RM" & sex == "F"))
shirep = indiv_repro(subset(foliv, species == "SH" & sex == "F")); sfirep = indiv_repro(subset(foliv, species == "SF" & sex == "F")); naoirep = indiv_repro(subset(foliv, species == "NAO" & sex == "F"))
otirep = indiv_repro(subset(insec, species == "OT" & sex == "F")); olirep = indiv_repro(subset(insec, species == "OL" & sex == "F"))
plot(c(1:12), doreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "DO - krat")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), dmreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "DM - krat")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
pdf("Fig3_avg_prop_reprodfemales.pdf", 7, 10, paper = "letter", pointsize = 10)
par(mfrow=c(5,3))
#plot mean fecundity by month for each species
plot(c(1:12), doreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "DO - krat")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), dmreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "DM - krat")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), pbreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "PB - pocket mouse")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), ppreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "PP - pocket mouse")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), pfreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "PF - pocket mouse")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), pereprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "PE - cactus mouse")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), pmreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "PM - deer mouse")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), rmreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "RM - harvest mouse")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), shreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "SH - cotton rat")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), sfreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "SF - cotton rat")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), naoreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "NA - pack rat")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), otreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "OT - grasshopper mouse")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
plot(c(1:12), olreprd, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "proprotion reproductive fem.", bty = "n", main = "OL - grasshopper mouse")
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
dev.off()
pdf("Fig6_indiv_repro_trends.pdf", 6, 6, pointsize = 10)
par(mfrow=c(2,2))
#plot the relative abundance of females who represent each number of reproductive events per year
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events",
ylab = "proportion females", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), bty = "n", main = "heteromyids")
points(c(0:3), table(doirep$num_reprod)/sum(table(doirep$num_reprod)), type = "b", pch = 19, col = "indianred")
points(c(0:4), table(dmirep$num_reprod)/sum(table(dmirep$num_reprod)), type = "b", pch = 19, col = "magenta")
points(c(0:4), table(pbirep$num_reprod)/sum(table(pbirep$num_reprod)), type = "b", pch = 19, col = "red")
points(c(0:4), table(ppirep$num_reprod)/sum(table(ppirep$num_reprod)), type = "b", pch = 19, col = "hotpink")
points(c(0:2), table(pfirep$num_reprod)/sum(table(pfirep$num_reprod)), type = "b", pch = 19, col = "purple")
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events",
ylab = "proportion females", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), bty = "n", main = "cricetids")
points(c(0:2), table(peirep$num_reprod)/sum(table(peirep$num_reprod)), type = "b", pch = 18, col = "green")
points(c(0:2), table(pmirep$num_reprod)/sum(table(pmirep$num_reprod)), type = "b", pch = 18, col = "darkgreen")
points(c(0:1), table(rmirep$num_reprod)/sum(table(rmirep$num_reprod)), type = "b", pch = 18, col = "yellowgreen")
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events",
ylab = "proportion females", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), bty = "n", main = "folivores")
points(c(0:1), table(shirep$num_reprod)/sum(table(shirep$num_reprod)), type = "b", pch = 17, col = "brown")
points(c(0:1), table(sfirep$num_reprod)/sum(table(sfirep$num_reprod)), type = "b", pch = 17, col = "brown4")
points(c(0:3), table(naoirep$num_reprod)/sum(table(naoirep$num_reprod)), type = "b", pch = 17, col = "goldenrod4")
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events",
ylab = "proportion females", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), main = "carnivores")
points(c(0:3), table(otirep$num_reprod)/sum(table(otirep$num_reprod)), type = "b", pch = 15, col = "orange3")
points(c(0:1), table(olirep$num_reprod)/sum(table(olirep$num_reprod)), type = "b", pch = 15, col = "orange4")
dev.off()
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events",
ylab = "proportion females", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), main = "carnivores")
points(c(0:1), table(olirep$num_reprod)/sum(table(olirep$num_reprod)), type = "b", pch = 15, col = "orange4")
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events", bty = "n",
ylab = "proportion females", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), main = "carnivores")
points(c(0:3), table(otirep$num_reprod)/sum(table(otirep$num_reprod)), type = "b", pch = 15, col = "orange3")
points(c(0:1), table(olirep$num_reprod)/sum(table(olirep$num_reprod)), type = "b", pch = 15, col = "orange4")
textxy(0, olirep$num_reprod[1], "OL")
olirep[1,]$numreprod
dev.off()
olirep[1,]$numreprod
olirep$numreprod
olirep$num_reprod
olirep$num_reprod[1]
points(c(0:1), table(olirep$num_reprod)/sum(table(olirep$num_reprod)), type = "b", pch = 15, col = "orange4")
plot(NA, NA, xlim = c(0, 4), xaxp = c(0, 4, 4), xlab = "number reproductive events", bty = "n",
ylab = "proportion females", type = "b", pch = 19, ylim = c(0, 1), yaxp = c(0, 1, 4), main = "carnivores")
points(c(0:3), table(otirep$num_reprod)/sum(table(otirep$num_reprod)), type = "b", pch = 15, col = "orange3")
points(c(0:1), table(olirep$num_reprod)/sum(table(olirep$num_reprod)), type = "b", pch = 15, col = "orange4")
textxy(0, olirep$num_reprod[1], "OL")
pdf("Fig7_mo-yr_repro_trends.pdf", 7, 10, paper = "letter", pointsize = 10)
par(mfrow=c(4,3))
alldat = rbind(doreprdyr, dmreprdyr, pbreprdyr, ppreprdyr, pfreprdyr, pereprdyr, pmreprdyr, rmreprdyr,
shreprdyr, sfreprdyr, naoreprdyr, otreprdyr, olreprdyr)
years = c(2000:2009)
spp = c("DO", 'DM', 'PB', 'PP', 'PF', 'PE', 'PM', 'RM', 'SH', 'NAO', 'OT', 'OL') #SF (fit all on a page, hardly reproduce anyway)
#plot proportion fecundity by month and year for each species
for (y in 1:length (years)){
for (s in 1:length (spp)) {
data = subset(alldat, year == years[y] & species == spp[s])
if(nrow(data) > 0){
plot(c(1:12), data$proprepro, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n", main =  paste(spp[s], years[y], sep = " "))
abline(h = 0.5, lty = 2, col = 'gray40', lwd = 1)
}
else {
plot(NA, NA, type = "l", xlim = c(1,12), ylim = c(0,1), pch = 19, xlab = "month",
ylab = "prop. reproductive F", bty = "n",  main = paste( "No", spp[s], years[y], sep = " "))
}}}
dev.off()
v6 = seq(-3,500,6)
Hgcount = hist(dometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 3500),
xlab = "meters", main = 'DO - krat')
# get a vector unique tags, then get a vector of distances moved for all recaptured individuals, by SPECIES
#heteromyids
dmtags = unique(het[het$species == "DM",]$tag); dotags = unique(het[het$species == "DO",]$tag); pbtags = unique(het[het$species == "PB",]$tag); pptags = unique(het[het$species == "PP",]$tag); pftags = unique(het[het$species == "PF",]$tag)
dmmeters = distance_moved(het[het$species == "DM",], dmtags); dometers = distance_moved(het[het$species == "DO",], dotags); pbmeters = distance_moved(het[het$species == "PB",], pbtags); ppmeters = distance_moved(het[het$species == "PP",], pptags); pfmeters = distance_moved(het[het$species == "PF",], pftags)
#cricetids
petags = unique(cricet[cricet$species == "PE",]$tag); pmtags = unique(cricet[cricet$species == "PM",]$tag); rmtags = unique(cricet[cricet$species == "RM",]$tag)
pemeters = distance_moved(cricet[cricet$species == "PE",], petags); pmmeters = distance_moved(cricet[cricet$species == "PM",], pmtags); rmmeters = distance_moved(cricet[cricet$species == "RM",], rmtags)
#folivores
shtags = unique(foliv[foliv$species == "SH",]$tag); sftags = unique(foliv[foliv$species == "SF",]$tag); naotags = unique(foliv[foliv$species == "NAO",]$tag)
shmeters = distance_moved(foliv[foliv$species == "SH",], shtags); sfmeters = distance_moved(foliv[foliv$species == "SF",], sftags); naometers = distance_moved(foliv[foliv$species == "NAO",], naotags)
#insectivores
oltags = unique(insec[insec$species == "OL",]$tag); ottags = unique(insec[insec$species == "OT",]$tag)
olmeters = distance_moved(insec[insec$species == "OL",], oltags); otmeters = distance_moved(insec[insec$species == "OT",], ottags)
# concatenate distance vectors for recaptured individuals by GUILD
Hgran = c(dmmeters, dometers, pbmeters, ppmeters, pfmeters)
Cgran = c(pemeters, pmmeters, rmmeters)
foli = c(shmeters, sfmeters) #separate NAO because they use different strategy - MIDDENS
insectiv = c(otmeters, olmeters)
# find breakpoints to use in MARK data structure for future analyses
# data reasonably well fits a lognormal distribution (eyeball and J. Powell)
# breakpoint = mean(logdata) + sd(logdata) of all the distances traveled by recaptured individuals
# using log1p, and back transforming using expm1 should solve the problem of lots of zeros
Hgran_brkpt = expm1(mean(log1p(Hgran)) + sd(log1p(Hgran)))
Cgran_brkpt = expm1(mean(log1p(Cgran)) + sd(log1p(Cgran)))
foli_brkpt = expm1(mean(log1p(foli)) + sd(log1p(foli)))
nao_brkpt = expm1(mean(log1p(naometers)) + sd(log1p(naometers)))
ins_brkpt = expm1(mean(log1p(insectiv)) + sd(log1p(insectiv)))
v6 = seq(-3,500,6)
Hgcount = hist(dometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 3500),
xlab = "meters", main = 'DO - krat')
Hgcount = hist(dometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 500),
xlab = "meters", main = 'DO - krat')
Hgcount = hist(dometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'DO - krat')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
library(fields)
xline(Hgran_brkpt, lwd = 2, col = "indianred")
dmcount = hist(dmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'DM - krat')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'PB - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'PP - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pfcount = hist(pfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'PF - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pfcount = hist(pfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 25),
xlab = "meters", main = 'PF - pocket mouse')
pfcount = hist(pfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 35),
xlab = "meters", main = 'PF - pocket mouse')
pfcount = hist(pfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 30),
xlab = "meters", main = 'PF - pocket mouse')
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'PP - pocket mouse')
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 550),
xlab = "meters", main = 'PP - pocket mouse')
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 750),
xlab = "meters", main = 'PP - pocket mouse')
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'PB - pocket mouse')
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 750),
xlab = "meters", main = 'PB - pocket mouse')
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 900),
xlab = "meters", main = 'PB - pocket mouse')
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 1500),
xlab = "meters", main = 'PB - pocket mouse')
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 2000),
xlab = "meters", main = 'PB - pocket mouse')
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 1750),
xlab = "meters", main = 'PB - pocket mouse')
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 1800),
xlab = "meters", main = 'PB - pocket mouse')
dmcount = hist(dmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'DM - krat')
dmcount = hist(dmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 750),
xlab = "meters", main = 'DM - krat')
dmcount = hist(dmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 550),
xlab = "meters", main = 'DM - krat')
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 750),
xlab = "meters", main = 'PP - pocket mouse')
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 600),
xlab = "meters", main = 'PP - pocket mouse')
docount = hist(dometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'DO - krat')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
dmcount = hist(dmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 500),
xlab = "meters", main = 'DM - krat')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 20000),
xlab = "meters", main = 'PB - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 600),
xlab = "meters", main = 'PP - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pfcount = hist(pfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 30),
xlab = "meters", main = 'PF - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pecount = hist(pemeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,40),
xlab = "meters", main = 'PE - cactus mouse')
xline(Cgran_brkpt, lwd = 2, col = "indianred")
pmcount = hist(pmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'PM - deer mouse')
xline(foli_brkpt, lwd = 2, col = "indianred")
rmcount = hist(rmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'RM - harvest mouse')
xline(foli_brkpt, lwd = 2, col = "indianred")
nacount = hist(naometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'NA - pack rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
shcount = hist(shmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'SH - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
sfcount = hist(sfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'SF - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
pecount = hist(pemeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'PE - cactus mouse')
xline(Cgran_brkpt, lwd = 2, col = "indianred")
pmcount = hist(pmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'PM - deer mouse')
xline(foli_brkpt, lwd = 2, col = "indianred")
rmcount = hist(rmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'RM - harvest mouse')
xline(foli_brkpt, lwd = 2, col = "indianred")
nacount = hist(naometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'NA - pack rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
shcount = hist(shmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'SH - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
sfcount = hist(sfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'SF - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
nacount = hist(naometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'NA - pack rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
shcount = hist(shmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'SH - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
sfcount = hist(sfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'SF - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
otcount = hist(otmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,120),
xlab = "meters", main = 'OT - grasshopper mouse')
xline(ins_brkpt, lwd = 2, col = "indianred")
olcount = hist(olmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,120),
xlab = "meters", main = 'OL - grasshopper mouse')
xline(ins_brkpt, lwd = 2, col = "indianred")
otcount = hist(otmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,100),
xlab = "meters", main = 'OT - grasshopper mouse')
xline(ins_brkpt, lwd = 2, col = "indianred")
olcount = hist(olmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'OL - grasshopper mouse')
xline(ins_brkpt, lwd = 2, col = "indianred")
pdf("Fig11_species_movement_hist.pdf", 8, 5, pointsize = 10)
par(mfrow=c(3,2), mar=c(3,1.5,2,0.5), oma=c(1.5,2,1,1))
#plot histogram of all consecutive movement for rodents within a species 2000-2009
#create vector of breaks, incrementing by 6 meters (represents approx. 1 stake) since data are not actually continuous
v6 = seq(-3,500,6)
docount = hist(dometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'DO - krat')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
dmcount = hist(dmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 500),
xlab = "meters", main = 'DM - krat')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 20000),
xlab = "meters", main = 'PB - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 600),
xlab = "meters", main = 'PP - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pfcount = hist(pfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 30),
xlab = "meters", main = 'PF - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pecount = hist(pemeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'PE - cactus mouse')
xline(Cgran_brkpt, lwd = 2, col = "indianred")
pmcount = hist(pmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'PM - deer mouse')
xline(foli_brkpt, lwd = 2, col = "indianred")
rmcount = hist(rmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'RM - harvest mouse')
xline(foli_brkpt, lwd = 2, col = "indianred")
nacount = hist(naometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'NA - pack rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
shcount = hist(shmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'SH - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
sfcount = hist(sfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'SF - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
otcount = hist(otmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,100),
xlab = "meters", main = 'OT - grasshopper mouse')
xline(ins_brkpt, lwd = 2, col = "indianred")
olcount = hist(olmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'OL - grasshopper mouse')
xline(ins_brkpt, lwd = 2, col = "indianred")
dev.off()
pdf("Fig11_species_movement_hist.pdf", 8, 5, pointsize = 10)
par(mfrow=c(3,2), mar=c(3,1.5,2,0.5), oma=c(1.5,2,1,1))
#plot histogram of all consecutive movement for rodents within a species 2000-2009
#create vector of breaks, incrementing by 6 meters (represents approx. 1 stake) since data are not actually continuous
v6 = seq(-3,500,6)
docount = hist(dometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 350),
xlab = "meters", main = 'DO - krat')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
dmcount = hist(dmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 500),
xlab = "meters", main = 'DM - krat')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pbcount = hist(pbmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 2000),
xlab = "meters", main = 'PB - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
ppcount = hist(ppmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 600),
xlab = "meters", main = 'PP - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pfcount = hist(pfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0, 30),
xlab = "meters", main = 'PF - pocket mouse')
xline(Hgran_brkpt, lwd = 2, col = "indianred")
pecount = hist(pemeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'PE - cactus mouse')
xline(Cgran_brkpt, lwd = 2, col = "indianred")
pmcount = hist(pmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'PM - deer mouse')
xline(foli_brkpt, lwd = 2, col = "indianred")
rmcount = hist(rmmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'RM - harvest mouse')
xline(foli_brkpt, lwd = 2, col = "indianred")
nacount = hist(naometers, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,25),
xlab = "meters", main = 'NA - pack rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
shcount = hist(shmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'SH - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
sfcount = hist(sfmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'SF - cotton rat')
xline(nao_brkpt, lwd = 2, col = "indianred")
otcount = hist(otmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,100),
xlab = "meters", main = 'OT - grasshopper mouse')
xline(ins_brkpt, lwd = 2, col = "indianred")
olcount = hist(olmeters, breaks = v6, col = 'gray60', xlim = c(0,500), ylim = c(0,15),
xlab = "meters", main = 'OL - grasshopper mouse')
xline(ins_brkpt, lwd = 2, col = "indianred")
dev.off()
